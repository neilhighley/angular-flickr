"use strict";angular.module("photostreamApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$httpProvider","$routeProvider",function(a,b){b.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"}),a.defaults.useXDomain=!0,a.defaults.withCredentials=!0,delete a.defaults.headers.common["X-Requested-With"],a.defaults.headers.common.Accept="application/json",a.defaults.headers.common["Content-Type"]="application/json"}]),angular.module("photostreamApp").controller("MainCtrl",["PhotoService","$scope","$q","$rootScope",function(a,b,c,d){function e(a){b.quantityToShow=a,b.pictures=b.trimPictures(b.currentResult.results,a)}b.pictures=[],b.title="The Photos Title",b.currentResult={},b.searchText="",b.reqError="",b.quantityToShow=5,this.test=function(){return"OK"},b.trimPictures=function(a,c){if(void 0!==a){void 0===c&&(c=b.quantityToShow);for(var d=[],e=0;e<a.length;e++)c>e&&d.push(a[e]);return d}},d.$on("changeQuantityToShow",function(a,b){e(b.quantity)}),b.getPictures=function(d){b.title="search:"+d;var e=c.defer();return a.getPhotosBySearchString(d).then(function(a){-1===a.status?(b.currentResult={},b.pictures=[],b.reqError="Could not retrieve data"):(b.currentResult=a,b.pictures=b.trimPictures(b.currentResult.results,b.quantityToShow),b.reqError=""),e.resolve()},function(){b.currentResult={},b.pictures=[],b.reqError="Could not retrieve data",e.resolve()}),e.promise},b.DoSearch=function(){b.getPictures(b.searchText)},b.DoSearchWithText=function(a){return b.searchText=a,b.getPictures(a)}}]),angular.module("photostreamApp").directive("pictureFrame",[function(){return{restrict:"EC",templateUrl:"templates/d/picture-frame.html",scope:{data:"=",cssClass:"@",doSearch:"="},link:function(a){a.selectTag=function(b){a.doSearch(b)}}}}]),angular.module("photostreamApp").directive("amountFilter",["$rootScope",function(a){return{restrict:"EC",templateUrl:"templates/d/amount-filter.html",scope:{quantity:"@",cssClass:"@"},link:function(b){a.$broadcast("changeQuantityToShow",{quantity:b.quantity}),b.changeAmountToShow=function(){a.$broadcast("changeQuantityToShow",{quantity:b.quantity})}}}}]),angular.module("photostreamApp").service("PhotoService",["$http",function(a){function b(a){for(var b={page:1,pages:1,total:a.items.length,results:a.items},c=[],d=0;d<a.items.length;d++){var e=a.items[d],f=e.media.m,g={url:f,id:d,title:e.title,author:e.author,published:e.published,tags:e.tags};c.push(g)}return b.results=c,b}var c=function(a,c){var d=b(a.data),e={search:c,results:d.results,status:1};return e},d=function(a,b){return{search:b,results:a,status:-1}},e=function(a){var b="";return b="http://www.flickr.com/services/feeds/photos_public.gne?tags="+a+"&format=json&jsoncallback=JSON_CALLBACK&"},f=function(b){return a({method:"JSONP",url:e(b)}).then(function(a){return c(a,b)},function(a){return d(a,b)})};return{test:function(){return"OK"},getPhotosBySearchString:function(a){return f(a)}}}]),angular.module("photostreamApp").run(["$templateCache",function(a){a.put("views/main.html",'<div class="srch"> <input type="text" ng-model="searchText"><button class="btn btn-default" type="button" ng-click="DoSearch()">Get</button> </div> <div class="PhotoOutput row" ng-if="pictures.length!=0" ng-model="pictures"> <div class="col-sm-6 col-md-4 col-lg-3" ng-repeat="picture in pictures"> <picture-frame css-class="pf" do-search="DoSearchWithText" data="picture"></picture-frame> </div> </div> <div ng-if="reqError!=\'\'">{{reqError}}</div> <div class="NoPhotoOutput" ng-if="reqError==\'\' && pictures.length==0">No Pictures retrieved</div>')}]);